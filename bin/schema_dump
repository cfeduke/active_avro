#!/usr/bin/env ruby
if ARGV.length == 0 || ARGV[0].nil?
  puts "Model name required"
  exit 0
end
$: << "#{File.dirname(__FILE__)}/../lib"
model_path = "#{`pwd`.chomp}/app/models"
if Dir.exists?(model_path)
  $: << model_path
else
  puts "Warning: path #{model_path} not found (try running from your Rails application's root directory)'"
  exit 0
end

require 'active_avro'
require 'active_support/inflector'
unless require ARGV[0]
  puts "Model #{ARGV[0]} not found in $:"
  exit 0
end

s = ActiveAvro::Schema.new(ARGV[0])
puts s.to_json